@page "/update/{feederId}"
@using HummingbirdFeeder.Data;
@using Microsoft.EntityFrameworkCore;
@using System.Globalization;
@using Microsoft.AspNetCore.Components;

@inject IDbContextFactory<FeederDataContext> FeederDataContextFactory;

@if (FeederToUpdate == null)
{
    <h1>Loading...</h1>
}
else
{
    <h1>Update Feeder "@FeederToUpdate.FeederName"</h1>

    <EditForm Model="FeederToUpdate" OnValidSubmit="UpdateFeeder">

        <div class="form-group mb-3">
            <label for="feederName">Feeder Name</label>
            <InputText @bind-Value="FeederToUpdate.FeederName" class="form-control" id="feederName" />
        </div>

        <div class="form-group mb-3">
            <label for="feederZipcode">Zip Code (Must be 5 digits)</label>
            <InputText @bind-Value="FeederToUpdate.Zipcode" class="form-control" id="feederZipcode" pattern="\d{5}" @oninput="ValidateForm"/>
            <ValidationMessage For="@(() => FeederToUpdate.Zipcode)" />
        </div>

        <div class="form-group mb-3">
            <label for="feederChangeDate">Last Date Feeder Was Changed</label>
            <InputDate @bind-Value="InputLastChangeDate" class="form-control" id="feederLastChangeDate" @oninput="ValidateForm" />
            <ValidationMessage For="@(() => InputLastChangeDate)" />
            @if (IsDateInFuture)
            {
                <div class="alert alert-warning" role="alert">
                    Are you from the future!? Please enter either today's date or a date in the past.
                </div>
            }
        </div>
        <button class="btn btn-success" type="submit" disabled=@IsSaveDisabled>Save</button>
        <button class="btn btn-secondary" @onclick="@(() => navigationManager.NavigateTo("/"))">Cancel</button>
    </EditForm>
}
